image: osakared/haxe-ci

test:
  script:
   - npm install
   - npx lix download
   - export TZ='America/Los_Angeles'
   - npx haxe tests.hxml -cpp bin/cpp                   && ./bin/cpp/RunTests
   - npx haxe tests.hxml -hl bin/tests.hl               && npx hl ./bin/tests.hl
   - npx haxe tests.hxml -neko bin/tests.n              && npx neko bin/tests.n

release:
  stage: deploy
  only:
    - tags
  script:
    - bash ./scripts/release_haxelib.sh $HAXELIB_PWD
